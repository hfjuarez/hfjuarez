---
import { title as aboutTitle } from '@/contents/about.json';
import me from '@/contents/me';
---

<nav id="general-navbar">
	<div class="nav-blur">
		<div></div>
		<div></div>
		<div></div>
		<div></div>
	</div>
	<div class="nav-content">
		<a href="#about" aria-label={`Go to About - ${aboutTitle}`}>{aboutTitle}</a>
		<a
			class="a-cta"
			href=`mailto:${me.contact.email}`
			aria-label="Send me an email"
			target="_blank"
			rel="noopener noreferrer">Let's talk</a
		>
	</div>
</nav>

<script>
	document.addEventListener('scroll', function () {
		const navbar = document.getElementById('general-navbar');
		const halfNavHeight = (100 * (navbar.offsetHeight / 2)) / 100;
		const threshold = (100 * window.innerHeight) / 100; // 100sdh equivalent
		const aList = document.getElementsByTagName('a');

		if (window.scrollY > threshold - halfNavHeight) {
			navbar.classList.add('invert-colors');
			for (const element of aList) {
				element.classList.add('invert-color');
			}
		} else {
			navbar.classList.remove('invert-colors');
			for (const element of aList) {
				element.classList.remove('invert-color');
			}
		}
	});
</script>

<style lang="scss">
	@import '@/styles/colors.scss';
	@import '@/styles/spaces.scss';

	#general-navbar {
		position: fixed;
		top: 0;
		left: 0;
		margin: 0;
		min-width: 100vw;
		width: 100vw;
		z-index: 50;
		padding: $space-1 $space-4;
		.nav-blur {
			position: absolute;
			z-index: 5;
			left: 0;
			top: 0;
			width: 100%;
			height: 200%;
			transform-origin: left top;
			pointer-events: none;
			transition:
				1s transform cubic-bezier(0.55, 0, 0.1, 1),
				1s height cubic-bezier(0.55, 0, 0.1, 1);
			transform: translateZ(0) translateY(-30%);
			div {
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
			}
			div:nth-of-type(1) {
				z-index: 2;
				-webkit-backdrop-filter: blur(0.0625rem);
				backdrop-filter: blur(0.0625rem);
				-webkit-mask: linear-gradient(
					to top,
					rgba(255, 255, 255, 0) 0%,
					rgb(255, 255, 255) 12.5%,
					rgb(255, 255, 255) 37.5%,
					rgba(255, 255, 255, 0) 50%
				);
			}
			div:nth-of-type(2) {
				z-index: 3;
				-webkit-backdrop-filter: blur(0.125rem);
				backdrop-filter: blur(0.125rem);
				-webkit-mask: linear-gradient(
					to top,
					rgba(255, 255, 255, 0) 12.5%,
					rgb(255, 255, 255) 37.5%,
					rgb(255, 255, 255) 50%,
					rgba(255, 255, 255, 0) 62.5%
				);
			}
			div:nth-of-type(3) {
				z-index: 4;
				-webkit-backdrop-filter: blur(0.25rem);
				backdrop-filter: blur(0.25rem);
				-webkit-mask: linear-gradient(
					to top,
					rgba(255, 255, 255, 0) 37.5%,
					rgb(255, 255, 255) 50%,
					rgb(255, 255, 255) 62.5%,
					rgba(255, 255, 255, 0) 75%
				);
			}
			div:nth-of-type(4) {
				z-index: 5;
				-webkit-backdrop-filter: blur(0.5rem);
				backdrop-filter: blur(0.5rem);
				-webkit-mask: linear-gradient(
					to top,
					rgba(255, 255, 255, 0) 50%,
					rgb(255, 255, 255) 62.5%,
					rgb(255, 255, 255) 75%,
					rgba(255, 255, 255, 0) 87.5%
				);
			}
		}
		.nav-content {
			position: relative;
			display: flex;
			justify-content: flex-end;
			align-items: center;
			z-index: 54;
			gap: $space-1 + 0.5rem;
			a {
				transition: color 0.5s ease-in-out;
				&.a-cta {
					background-color: $strongForegroundColor;
					color: $backgroundColor;
					padding: $space-1 / 8 $space-1 / 2;
					border-radius: 0.125rem;
					&:hover {
						color: $strongBackgroundColor;
					}
					&:focus-visible,
					&:focus {
						color: $strongBackgroundColor;
					}
					&:active {
						color: $strongBackgroundColor;
					}
				}
			}
		}
		&.invert-colors {
			.nav-content {
				.a-cta {
					background-color: $strongBackgroundColor;
					color: $foregroundColor;
					&:hover {
						color: $strongForegroundColor;
					}
					&:focus-visible,
					&:focus {
						color: $strongForegroundColor;
					}
					&:active {
						color: $strongForegroundColor;
					}
				}
			}
		}
	}
</style>
